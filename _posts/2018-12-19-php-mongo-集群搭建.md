---
layout:     post
title:      "mongodb 分布式集群数据存储搭建"
subtitle:   "如何安装php扩展"
date:       2018-12-19 12:00:00
author:     "Ikin"
catalog: php
tags:
    - php
    - mongo
---
### 分片
#### 基本概念
* mongos：即路由器，可以有多个，相当于一个控制中心，负责路由和协调操作，使得集群像一个整体的系统。
* config server：存储集群的信息，包括分片和块数据信息。主要存储块数据信息，每个config server上都有一份所有块数据信息的拷贝，以保证每台config server上的数据的一致性。
* 分片 置分片时，需要从集合里面选一个键，用该键的值作为数据拆分的依据。这个键称为片键(shard key)。  
{department:"IT",name:"zhangsan"},{department:"HR",name:"lisi"},{department:"SUPPORT",name:"zhaowu"}
以该数据为例，表示的是职员名字以及所在的部门，假若我们设置部门（department）为片键，那么第一片可能存放名称以字母A-F开头的部门，第二片存放名称以G~P开头的部门，第三片存Q~Z，
请求步骤：客户端 =》Server=》 请求=》 mongos=》 config Server


* 参考文档及拓展阅读  
[1.mongodb Profiling 通过慢查询日志分析查询慢的原因 相应优化](http://blog.51cto.com/qiangsh/2052609)  
[2.mongodb监控工具mongostat](https://blog.csdn.net/u011186019/article/details/70918288)
[2.Mongodb 参数限制/阀值/](https://blog.csdn.net/cx136295988/article/details/73496784)